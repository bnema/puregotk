// Package gio was automatically generated by github.com/jwijenbergh/puregotk DO NOT EDIT
package gio

import (
	"structs"
	"unsafe"

	"github.com/jwijenbergh/purego"
	"github.com/jwijenbergh/puregotk/pkg/core"
	"github.com/jwijenbergh/puregotk/v4/gobject/types"
)

// An interface for file descriptor based io objects.
type FileDescriptorBasedIface struct {
	_ structs.HostLayout

	GIface uintptr

	xGetFd uintptr
}

func (x *FileDescriptorBasedIface) GoPointer() uintptr {
	return uintptr(unsafe.Pointer(x))
}

// OverrideGetFd sets the callback function.
// Gets the underlying file descriptor.
func (x *FileDescriptorBasedIface) OverrideGetFd(cb func(FileDescriptorBased) int) {
	if cb == nil {
		x.xGetFd = 0
	} else {
		x.xGetFd = purego.NewCallback(func(FdBasedVarp uintptr) int {
			return cb(&FileDescriptorBasedBase{Ptr: FdBasedVarp})
		})
	}
}

// GetGetFd gets the callback function.
// Gets the underlying file descriptor.
func (x *FileDescriptorBasedIface) GetGetFd() func(FileDescriptorBased) int {
	if x.xGetFd == 0 {
		return nil
	}
	var rawCallback func(FdBasedVarp uintptr) int
	purego.RegisterFunc(&rawCallback, x.xGetFd)
	return func(FdBasedVar FileDescriptorBased) int {
		return rawCallback(FdBasedVar.GoPointer())
	}
}

// `GFileDescriptorBased` is an interface for file descriptor based IO.
//
// It is implemented by streams (implementations of [class@Gio.InputStream] or
// [class@Gio.OutputStream]) that are based on file descriptors.
//
// Note that `&lt;gio/gfiledescriptorbased.h&gt;` belongs to the UNIX-specific
// GIO interfaces, thus you have to use the `gio-unix-2.0.pc` pkg-config
// file or the `GioUnix-2.0` GIR namespace when using it.
type FileDescriptorBased interface {
	GoPointer() uintptr
	SetGoPointer(uintptr)
	GetFd() int
}

var xFileDescriptorBasedGLibType func() types.GType

func FileDescriptorBasedGLibType() types.GType {
	return xFileDescriptorBasedGLibType()
}

type FileDescriptorBasedBase struct {
	Ptr uintptr
}

func (x *FileDescriptorBasedBase) GoPointer() uintptr {
	if x == nil {
		return 0
	}
	return x.Ptr
}

func (x *FileDescriptorBasedBase) SetGoPointer(ptr uintptr) {
	x.Ptr = ptr
}

// Gets the underlying file descriptor.
func (x *FileDescriptorBasedBase) GetFd() int {

	cret := XGFileDescriptorBasedGetFd(x.GoPointer())
	return cret
}

var XGFileDescriptorBasedGetFd func(uintptr) int

func init() {
	core.SetPackageName("GIO", "gio-2.0")
	core.SetSharedLibraries("GIO", []string{"libgio-2.0.so.0"})
	var libs []uintptr
	for _, libPath := range core.GetPaths("GIO") {
		lib, err := purego.Dlopen(libPath, purego.RTLD_NOW|purego.RTLD_GLOBAL)
		if err != nil {
			panic(err)
		}
		libs = append(libs, lib)
	}

	core.PuregoSafeRegister(&xFileDescriptorBasedGLibType, libs, "g_file_descriptor_based_get_type")

	core.PuregoSafeRegister(&XGFileDescriptorBasedGetFd, libs, "g_file_descriptor_based_get_fd")

}
